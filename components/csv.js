import Axios from "axios";


async function getStatus(registerationNumber) {
    let url = "https://cors-anywhere.herokuapp.com/http://www.odata.charities.govt.nz/Organisations?$filter=CharityRegistrationNumber eq '" + registerationNumber + "'&$format=json";
    let data = [];
    let financial = [];

    await Axios.get(url).then(function (response) {
        data = JSON.parse(response.request.response);
    });

    if (data.d[0]['RegistrationStatus'] === 'Deregistered') {
        return;
    }

    let suburb = data.d[0]['StreetAddress_suburb'];
    let city = data.d[0]['StreetAddress_city'];
    let location = suburb + ',' + city;

    await Axios.get("https://cors-anywhere.herokuapp.com/" + data.d[0]['AnnualReturn']['__deferred']['uri']).then(function (response) {
        let length = response.data.d.length;
        financial = response.data.d[length - 1]['TotalExpenditure']; 
    });

    return (location, financial);
};

export function generateCSV() {
    let data = [
        "CC49286",
        "CC48103",
        "CC48519",
        "CC49017",
        "CC50425",
        "CC48539",
        "CC48540",
        "CC48800",
        "CC48411",
        "CC48597",
        "CC48813",
        "CC48389",
        "CC48897",
        "CC48109",
        "CC48097",
        "CC48094",
        "CC48106",
        "CC48114",
        "CC48412",
        "CC48997",
        "CC48736",
        "CC50245",
        "CC48906",
        "CC49258",
        "CC49109",
        "CC49560",
        "CC48950",
        "CC49119",
        "CC48633",
        "CC49414",
        "CC48494",
        "CC49687",
        "CC50006",
        "CC48545",
        "CC48816",
        "CC48731",
        "CC48786",
        "CC48676",
        "CC48513",
        "CC48741",
        "CC48742",
        "CC48506",
        "CC49403",
        "CC48822",
        "CC48889",
        "CC48737",
        "CC48781",
        "CC48801",
        "CC48701",
        "CC50083",
        "CC49318",
        "CC48738",
        "CC48967",
        "CC48554",
        "CC48665",
        "CC49121",
        "CC49046",
        "CC49971",
        "CC48601",
        "CC48512",
        "CC48502",
        "CC48721",
        "CC48928",
        "CC48740",
        "CC48704",
        "CC48651",
        "CC48655",
        "CC48503",
        "CC49253",
        "CC49869",
        "CC48926",
        "CC50388",
        "CC48493",
        "CC48881",
        "CC49437",
        "CC48523",
        "CC49336",
        "CC48953",
        "CC48659",
        "CC49588",
        "CC48969",
        "CC48687",
        "CC48510",
        "CC49113",
        "CC48749",
        "CC48672",
        "CC48733",
        "CC49185",
        "CC49143",
        "CC48541",
        "CC49071",
        "CC49788",
        "CC48511",
        "CC48525",
        "CC49442",
        "CC48974",
        "CC48794",
        "CC48643",
        "CC48784",
        "CC49160",
        "CC48608",
        "CC48819",
        "CC48857",
        "CC48531",
        "CC49293",
        "CC49201",
        "CC49019",
        "CC49321",
        "CC49112",
        "CC48567",
        "CC48516",
        "CC48520",
        "CC48708",
        "CC48565",
        "CC48514",
        "CC48607",
        "CC49116",
        "CC48892",
        "CC49043",
        "CC48992",
        "CC48883",
        "CC48461",
        "CC48832",
        "CC48921",
        "CC50753",
        "CC48868",
        "CC48562",
        "CC48538",
        "CC48543",
        "CC48550",
        "CC49395",
        "CC48377",
        "CC48615",
        "CC49168",
        "CC48544",
        "CC49292",
        "CC50091",
        "CC49138",
        "CC48865",
        "CC48866",
        "CC49600",
        "CC48552",
        "CC49069",
        "CC48548",
        "CC49322",
        "CC48470",
        "CC48542",
        "CC50134",
        "CC49031",
        "CC48821",
        "CC48994",
        "CC48724",
        "CC48745",
        "CC48850",
        "CC49278",
        "CC48956",
        "CC48476",
        "CC48584",
        "CC49712",
        "CC48706",
        "CC50508",
        "CC48570",
        "CC49056",
        "CC48553",
        "CC48634",
        "CC48719",
        "CC49366",
        "CC49314",
        "CC48645",
        "CC48799",
        "CC48940",
        "CC49034",
        "CC48599",
        "CC49066",
        "CC48589",
        "CC49473",
        "CC48639",
        "CC48818",
        "CC48755",
        "CC48764",
        "CC48763",
        "CC48836",
        "CC50189",
        "CC48568",
        "CC48646",
        "CC48580",
        "CC48817",
        "CC48593",
        "CC49052",
        "CC49819",
        "CC49569",
        "CC48702",
        "CC48588",
        "CC48847",
        "CC49015",
        "CC48833",
        "CC50056",
        "CC48571",
        "CC48710",
        "CC48975",
        "CC48757",
        "CC48746",
        "CC48835",
        "CC48957",
        "CC48616",
        "CC48644",
        "CC49589",
        "CC48640",
        "CC48848",
        "CC49704",
        "CC48837",
        "CC48596",
        "CC48610",
        "CC49352",
        "CC48617",
        "CC48609",
        "CC49409",
        "CC48805",
        "CC48791",
        "CC49156",
        "CC48907",
        "CC48683",
        "CC49209",
        "CC48574",
        "CC49284",
        "CC48812",
        "CC48697",
        "CC49012",
        "CC49394",
        "CC48845",
        "CC49769",
        "CC48890",
        "CC48913",
        "CC48648",
        "CC48641",
        "CC49486",
        "CC49975",
        "CC49344",
        "CC49220",
        "CC48893",
        "CC49093",
        "CC48679",
        "CC48547",
        "CC48772",
        "CC48808",
        "CC48947",
        "CC48986",
        "CC49524",
        "CC48698",
        "CC49108",
        "CC49472",
        "CC50828",
        "CC48766",
        "CC49101",
        "CC49667",
        "CC48783",
        "CC48806",
        "CC49130",
        "CC49073",
        "CC48668",
        "CC49808",
        "CC48780",
        "CC49018",
        "CC48751",
        "CC48682",
        "CC48723",
        "CC48831",
        "CC48699",
        "CC48846",
        "CC50247",
        "CC49054",
        "CC48844",
        "CC49420",
        "CC48862",
        "CC48942",
        "CC48968",
        "CC49172",
        "CC48998",
        "CC48870",
        "CC48875",
        "CC48903",
        "CC49007",
        "CC49097",
        "CC48886",
        "CC49008",
        "CC48713",
        "CC48863",
        "CC49128",
        "CC50271",
        "CC48859",
        "CC49111",
        "CC48996",
        "CC49195",
        "CC49912",
        "CC49176",
        "CC48896",
        "CC48943",
        "CC48989",
        "CC48877",
        "CC48878",
        "CC50454",
        "CC49402",
        "CC48894",
        "CC48938",
        "CC48949",
        "CC50993",
        "CC49161",
        "CC49399",
        "CC49104",
        "CC48810",
        "CC49767",
        "CC49792",
        "CC48936",
        "CC49249",
        "CC48752",
        "CC48753",
        "CC49061",
        "CC49060",
        "CC50559",
        "CC49340",
        "CC49163",
        "CC49346",
        "CC49188",
        "CC49425",
        "CC50192",
        "CC48902",
        "CC48935",
        "CC49117",
        "CC49432",
        "CC49266",
        "CC48939",
        "CC49065",
        "CC48937",
        "CC49365",
        "CC49027",
        "CC49303",
        "CC48916",
        "CC49151",
        "CC48841",
        "CC48904",
        "CC48884",
        "CC48891",
        "CC49039",
        "CC49550",
        "CC48954",
        "CC49345",
        "CC48934",
        "CC50060",
        "CC49219",
        "CC49164",
        "CC48909",
        "CC49666",
        "CC49275",
        "CC48912",
        "CC49539",
        "CC49107",
        "CC49279",
        "CC48995",
        "CC48899",
        "CC49264",
        "CC48925",
        "CC48944",
        "CC49424",
        "CC49245",
        "CC48914",
        "CC49583",
        "CC49624",
        "CC49310",
        "CC49191",
        "CC49210",
        "CC48910",
        "CC49610",
        "CC48908",
        "CC48827",
        "CC49136",
        "CC48927",
        "CC48961",
        "CC50070",
        "CC49095",
        "CC49549",
        "CC48977",
        "CC48945",
        "CC50088",
        "CC48963",
        "CC49812",
        "CC48919",
        "CC48941",
        "CC49087",
        "CC49192",
        "CC49640",
        "CC48976",
        "CC49003",
        "CC50899",
        "CC48951",
        "CC48980",
        "CC49691",
        "CC49038",
        "CC49125",
        "CC49530",
        "CC48960",
        "CC49147",
        "CC50132",
        "CC49096",
        "CC49140",
        "CC50348",
        "CC48966",
        "CC50209",
        "CC48981",
        "CC48978",
        "CC49105",
        "CC49762",
        "CC48979",
        "CC48984",
        "CC48982",
        "CC50045",
        "CC48983",
        "CC49208",
        "CC48999",
        "CC48987",
        "CC50604",
        "CC49000",
        "CC49002",
        "CC49062",
        "CC49089",
        "CC49001",
        "CC49154",
        "CC49004",
        "CC49077",
        "CC49766",
        "CC49048",
        "CC49226",
        "CC49123",
        "CC49045",
        "CC50121",
        "CC49173",
        "CC49049",
        "CC49020",
        "CC49179",
        "CC49129",
        "CC49032",
        "CC51178",
        "CC49033",
        "CC49115",
        "CC49040",
        "CC49952",
        "CC49072",
        "CC49661",
        "CC51206",
        "CC51196",
        "CC51232",
        "CC51233",
        "CC51173",
        "CC51306",
        "CC51289",
        "CC51331",
        "CC51300",
        "CC51271",
        "CC51207",
        "CC51377",
        "CC51200",
        "CC51139",
        "CC51101",
        "CC50020",
        "CC49831",
        "CC49729",
        "CC50414",
        "CC49678",
        "CC49823",
        "CC50203",
        "CC49664",
        "CC49633",
        "CC49697",
        "CC49848",
        "CC50453",
        "CC49670",
        "CC49642",
        "CC49653",
        "CC49701",
        "CC50361",
        "CC50240",
        "CC49898",
        "CC50123",
        "CC49655",
        "CC49800",
        "CC49639",
        "CC49751",
        "CC49811",
        "CC49680",
        "CC49749",
        "CC49771",
        "CC49724",
        "CC50053",
        "CC49595",
        "CC49641",
        "CC49648",
        "CC49858",
        "CC51322",
        "CC49684",
        "CC49748",
        "CC49662",
        "CC49864",
        "CC50529",
        "CC50681",
        "CC50092",
        "CC49698",
        "CC50041",
        "CC49902",
        "CC49951",
        "CC49865",
        "CC49695",
        "CC49842",
        "CC49942",
        "CC49820",
        "CC50210",
        "CC49896",
        "CC49702",
        "CC49857",
        "CC50194",
        "CC49703",
        "CC49743",
        "CC50379",
        "CC50182",
        "CC49956",
        "CC49710",
        "CC49815",
        "CC50133",
        "CC49856",
        "CC49870",
        "CC50526",
        "CC49647",
        "CC49719",
        "CC49739",
        "CC50047",
        "CC49716",
        "CC51149",
        "CC49728",
        "CC49650",
        "CC49730",
        "CC49732",
        "CC49809",
        "CC49785",
        "CC49816",
        "CC49846",
        "CC50341",
        "CC49877",
        "CC49810",
        "CC50131",
        "CC49836",
        "CC49783",
        "CC49734",
        "CC49735",
        "CC50137",
        "CC50078",
        "CC49761",
        "CC50051",
        "CC50423",
        "CC50013",
        "CC49737",
        "CC49683",
        "CC49742",
        "CC49740",
        "CC49745",
        "CC49746",
        "CC49747"
      ];

      const rows = []

    for (var i = 0; i < 3; i++) {
        let financial = getStatus(data[i])[0];

        console.log(financial)
    };
}